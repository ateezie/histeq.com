{#
  Historic Equity Testimonial Component
  Client testimonials with quotes, attribution, and company logos
#}

{% set testimonial = testimonial|default({}) %}

<!-- Single Testimonial Card -->
<div class="testimonial-card bg-white rounded-2xl shadow-card hover:shadow-card-hover transition-all duration-300 p-8 lg:p-10">
    <!-- Quote Icon -->
    <div class="mb-6">
        <svg class="w-10 h-10 text-primary-600 opacity-60" fill="currentColor" viewBox="0 0 32 32">
            <path d="M10 8c-3.3 0-6 2.7-6 6v10h10V14h-4c0-2.2 1.8-4 4-4V8zm12 0c-3.3 0-6 2.7-6 6v10h10V14h-4c0-2.2 1.8-4 4-4V8z"/>
        </svg>
    </div>

    <!-- Testimonial Quote -->
    <blockquote class="text-lg lg:text-xl text-navy-900 leading-relaxed mb-8 font-medium italic">
        "{{ testimonial.quote|default('Historic Equity transformed our challenging rehabilitation project into a financial success story.') }}"
    </blockquote>

    <!-- Client Information -->
    <div class="flex items-center justify-between">
        <div class="flex items-center">
            {% if testimonial.client_photo %}
                <img src="{{ testimonial.client_photo }}"
                     alt="{{ testimonial.client_name }}"
                     class="w-12 h-12 rounded-full object-cover mr-4">
            {% else %}
                <div class="w-12 h-12 bg-neutral-lighter rounded-full flex items-center justify-center mr-4">
                    <svg class="w-6 h-6 text-neutral-medium" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M24 20.993V24H0v-2.996A14.977 14.977 0 0112.004 15c4.904 0 9.26 2.354 11.996 5.993zM16.002 8.999a4 4 0 11-8 0 4 4 0 018 0z"/>
                    </svg>
                </div>
            {% endif %}
            <div>
                <div class="font-semibold text-navy-900">
                    {{ testimonial.client_name|default('John Anderson') }}
                </div>
                <div class="text-sm text-navy-700">
                    {{ testimonial.client_title|default('CEO, Landmark Developments') }}
                </div>
            </div>
        </div>

        <!-- Company Logo -->
        {% if testimonial.company_logo %}
            <img src="{{ testimonial.company_logo }}"
                 alt="{{ testimonial.company_name }}"
                 class="h-8 w-auto opacity-60 hover:opacity-100 transition-opacity duration-200">
        {% endif %}
    </div>
</div>

{# Testimonials Section with Multiple Testimonials #}
{% if testimonials %}
<section class="testimonials-section section-padding bg-neutral-white" id="testimonials">
    <div class="container-custom">
        <!-- Section Header -->
        <div class="text-center mb-16">
            <h2 class="text-3xl lg:text-4xl font-bold text-navy-900 mb-4">
                {{ section_title|default('Client Testimonials') }}
            </h2>
            <p class="text-lg text-navy-700 max-w-2xl mx-auto">
                {{ section_subtitle|default('What our partners say about working with Historic Equity Inc') }}
            </p>
        </div>

        <!-- Testimonials Grid -->
        <div class="grid lg:grid-cols-2 gap-8 lg:gap-12">
            {% for testimonial in testimonials %}
                {% include 'components/testimonial.twig' with { testimonial: testimonial } %}
            {% endfor %}
        </div>

        <!-- Additional Trust Indicators -->
        {% if show_trust_indicators|default(true) %}
            <div class="mt-16 pt-12 border-t border-neutral-lighter">
                <div class="text-center mb-8">
                    <h3 class="text-xl font-semibold text-navy-900 mb-2">Trusted by Leading Organizations</h3>
                    <p class="text-navy-700">Partners who trust Historic Equity Inc with their projects</p>
                </div>

                <!-- Logo Grid -->
                <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-8 items-center justify-items-center">
                    {% for logo in client_logos|default([]) %}
                        <img src="{{ logo.src }}"
                             alt="{{ logo.alt }}"
                             class="h-12 w-auto opacity-50 hover:opacity-100 transition-opacity duration-200 grayscale hover:grayscale-0">
                    {% endfor %}
                </div>
            </div>
        {% endif %}
    </div>
</section>
{% endif %}

{# Testimonial Slider Component #}
<div class="testimonial-slider relative" id="testimonial-slider">
    <!-- Slider Container -->
    <div class="overflow-hidden">
        <div class="flex transition-transform duration-500 ease-in-out" id="slider-track">
            {% for testimonial in testimonials %}
                <div class="w-full flex-shrink-0">
                    {% include 'components/testimonial.twig' with { testimonial: testimonial } %}
                </div>
            {% endfor %}
        </div>
    </div>

    <!-- Navigation Arrows -->
    <button class="absolute top-1/2 left-4 transform -translate-y-1/2 bg-white shadow-lg rounded-full p-3 hover:bg-neutral-lighter transition-colors duration-200"
            onclick="previousSlide()">
        <svg class="w-5 h-5 text-navy-900" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
        </svg>
    </button>

    <button class="absolute top-1/2 right-4 transform -translate-y-1/2 bg-white shadow-lg rounded-full p-3 hover:bg-neutral-lighter transition-colors duration-200"
            onclick="nextSlide()">
        <svg class="w-5 h-5 text-navy-900" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
        </svg>
    </button>

    <!-- Dots Indicator -->
    <div class="flex justify-center mt-8 space-x-2">
        {% for i in range(testimonials|length) %}
            <button class="w-3 h-3 rounded-full bg-neutral-400 hover:bg-primary-600 transition-colors duration-200"
                    onclick="goToSlide({{ i }})"></button>
        {% endfor %}
    </div>
</div>

<script>
// Simple testimonial slider functionality
let currentSlide = 0;
const totalSlides = {{ testimonials|length|default(0) }};

function updateSlider() {
    const sliderTrack = document.getElementById('slider-track');
    if (sliderTrack) {
        sliderTrack.style.transform = `translateX(-${currentSlide * 100}%)`;
    }

    // Update dots
    const dots = document.querySelectorAll('#testimonial-slider .w-3');
    dots.forEach((dot, index) => {
        if (index === currentSlide) {
            dot.classList.remove('bg-neutral-400');
            dot.classList.add('bg-primary-600');
        } else {
            dot.classList.remove('bg-primary-600');
            dot.classList.add('bg-neutral-400');
        }
    });
}

function nextSlide() {
    currentSlide = (currentSlide + 1) % totalSlides;
    updateSlider();
}

function previousSlide() {
    currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
    updateSlider();
}

function goToSlide(index) {
    currentSlide = index;
    updateSlider();
}

// Auto-advance slider every 6 seconds
if (totalSlides > 1) {
    setInterval(nextSlide, 6000);
}
</script>