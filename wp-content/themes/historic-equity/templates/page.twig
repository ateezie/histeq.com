{% extends "base.twig" %}

{% block content %}
    <main class="main-content" id="main-content" role="main">

        {# Hero Section #}
        {% if fields.page_hero_title or fields.page_hero_subtitle or fields.page_hero_image %}
            <section class="py-24 lg:py-32 bg-white" data-testid="page-hero">
                <div class="container mx-auto px-6 lg:px-12">
                    <div class="grid lg:grid-cols-2 gap-8 lg:gap-12 items-center max-w-6xl mx-auto">

                        <!-- Hero Content -->
                        <div class="space-y-6 lg:space-y-8">
                            {% if fields.page_hero_title %}
                                <h1 class="text-h1-mobile lg:text-h1-desktop text-navy-900 leading-[1.1] tracking-tight">
                                    {{ fields.page_hero_title }}
                                </h1>
                            {% else %}
                                <h1 class="text-h1-mobile lg:text-h1-desktop text-navy-900 leading-[1.1] tracking-tight">
                                    {{ post.title }}
                                </h1>
                            {% endif %}

                            {% if fields.page_hero_subtitle %}
                                <p class="text-text-lg lg:text-text-xl text-navy-700 leading-relaxed max-w-lg">
                                    {{ fields.page_hero_subtitle }}
                                </p>
                            {% endif %}
                        </div>

                        <!-- Hero Image -->
                        {% if fields.page_hero_image %}
                            <div>
                                <img src="{{ fields.page_hero_image.url }}"
                                     alt="{{ fields.page_hero_image.alt|default(fields.page_hero_title|default(post.title)) }}"
                                     class="w-full h-auto object-cover rounded-lg shadow-lg">
                            </div>
                        {% endif %}
                    </div>
                </div>
            </section>
        {% else %}
            {# Simple text-only hero #}
            <section class="py-24 lg:py-32 bg-white" data-testid="page-hero">
                <div class="container mx-auto px-6 lg:px-12">
                    <div class="text-center max-w-4xl mx-auto">
                        <h1 class="text-h1-mobile lg:text-h1-desktop text-navy-900 leading-[1.1] tracking-tight mb-6">
                            {{ post.title }}
                        </h1>
                    </div>
                </div>
            </section>
        {% endif %}

        {# Main Content #}
        {% if fields.page_main_content %}
            <section class="py-24 lg:py-32 bg-off-white" data-testid="main-content">
                <div class="container mx-auto px-6 lg:px-12">
                    <div class="max-w-4xl mx-auto prose prose-lg">
                        {{ fields.page_main_content }}
                    </div>
                </div>
            </section>
        {% endif %}

        {# Flexible Content Sections #}
        {% if fields.page_content_sections %}
            {% for section in fields.page_content_sections %}
                {% if section.acf_fc_layout == 'text_section' %}
                    <section class="py-24 lg:py-32 bg-white" data-testid="text-section">
                        <div class="container mx-auto px-6 lg:px-12">
                            <div class="max-w-4xl mx-auto">
                                {% if section.section_title %}
                                    <h2 class="text-h3-mobile lg:text-h3-desktop text-navy-900 mb-8 text-center">
                                        {{ section.section_title }}
                                    </h2>
                                {% endif %}
                                <div class="prose prose-lg">
                                    {{ section.section_content }}
                                </div>
                            </div>
                        </div>
                    </section>

                {% elseif section.acf_fc_layout == 'image_text_section' %}
                    <section class="py-24 lg:py-32 bg-off-white" data-testid="image-text-section">
                        <div class="container mx-auto px-6 lg:px-12">
                            <div class="grid lg:grid-cols-2 gap-8 lg:gap-12 items-center max-w-6xl mx-auto">

                                {% if section.layout == 'image_right' %}
                                    <!-- Text Left, Image Right -->
                                    <div class="space-y-6">
                                        {% if section.section_title %}
                                            <h2 class="text-h3-mobile lg:text-h3-desktop text-navy-900">
                                                {{ section.section_title }}
                                            </h2>
                                        {% endif %}
                                        <div class="prose prose-lg">
                                            {{ section.section_content }}
                                        </div>
                                    </div>
                                    {% if section.section_image %}
                                        <div>
                                            <img src="{{ section.section_image.url }}"
                                                 alt="{{ section.section_image.alt|default(section.section_title) }}"
                                                 class="w-full h-auto object-cover rounded-lg shadow-lg">
                                        </div>
                                    {% endif %}
                                {% else %}
                                    <!-- Image Left, Text Right -->
                                    {% if section.section_image %}
                                        <div>
                                            <img src="{{ section.section_image.url }}"
                                                 alt="{{ section.section_image.alt|default(section.section_title) }}"
                                                 class="w-full h-auto object-cover rounded-lg shadow-lg">
                                        </div>
                                    {% endif %}
                                    <div class="space-y-6">
                                        {% if section.section_title %}
                                            <h2 class="text-h3-mobile lg:text-h3-desktop text-navy-900">
                                                {{ section.section_title }}
                                            </h2>
                                        {% endif %}
                                        <div class="prose prose-lg">
                                            {{ section.section_content }}
                                        </div>
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </section>

                {% elseif section.acf_fc_layout == 'call_to_action' %}
                    <section class="py-24 lg:py-32 bg-white" data-testid="cta-section">
                        <div class="container mx-auto px-6 lg:px-12">
                            <div class="text-center max-w-4xl mx-auto">
                                {% if section.cta_title %}
                                    <h2 class="text-h3-mobile lg:text-h3-desktop text-navy-900 mb-6">
                                        {{ section.cta_title }}
                                    </h2>
                                {% endif %}
                                {% if section.cta_content %}
                                    <p class="text-text-lg lg:text-text-xl text-navy-700 mb-8 leading-relaxed">
                                        {{ section.cta_content }}
                                    </p>
                                {% endif %}
                                {% if section.button_text and section.button_link %}
                                    <a href="{{ section.button_link }}"
                                       class="inline-flex items-center justify-center px-8 py-3 bg-primary-600 text-white font-medium rounded-lg hover:bg-primary-700 transition-colors duration-200">
                                        {{ section.button_text }}
                                    </a>
                                {% endif %}
                            </div>
                        </div>
                    </section>
                {% endif %}
            {% endfor %}
        {% endif %}

        {# Default content if no ACF content #}
        {% if not fields.page_main_content and not fields.page_content_sections %}
            <section class="py-24 lg:py-32 bg-off-white" data-testid="default-content">
                <div class="container mx-auto px-6 lg:px-12">
                    <div class="max-w-4xl mx-auto prose prose-lg">
                        {{ post.content }}
                    </div>
                </div>
            </section>
        {% endif %}

    </main>
{% endblock %}